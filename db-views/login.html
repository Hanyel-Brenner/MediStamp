<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" >
    <!--<link rel = 'stylesheet' href = 'login.css' type="text/css">-->
    <link href='https://fonts.googleapis.com/css?family=Libre Franklin' rel='stylesheet'>
    <meta content='width = device-width, initial-scale = 1.0' >
</head>

<body>
<nav>
    <h2>Login</h2>
</nav>

<form id="login-form" method="POST" action="./login">
    <label>email</label> <input type="text" id="email" name="email" required> 
    <label>password</label> <input type="text" id="password" name="password" required> 
    <button type="submit">SUBMIT</button>
</form>

<p id="logged-in-message" style= "visibility : hidden"></p>

<a id ="redct-link" style = "visibility : hidden" href="/">Back to main page</a>
<br>
<a id ="logout-link" style = "visibility : hidden" href="/">Logout</a>

<script type="module">
    let loginForm = document.getElementById('login-form');
    let loggedInMessage = document.getElementById('logged-in-message');
    let redctLink = document.getElementById('redct-link');
    let logoutLink = document.getElementById('logout-link');
    logoutLink.addEventListener('click', () => {
        fetch('/endCookie');
    });

    let cookie = await fetch('/getCookie').then(response => response.json());
    if(cookie != null){
        loggedInMessage.textContent = 'User '+cookie.email+'is logged!';
        loggedInMessage.style.visibility = 'visible';
        redctLink.style.visibility = 'visible';
        logoutLink.style.visibility = 'visible';
        loginForm.style.display = 'none';
    }

</script>

</body>

</html>